# picobrowser - Writeup

## Challenge Information

- **Name:** picobrowser
- **Category:** Web Exploitation
- **Difficulty:** Easy
- **Points:** (varies)
- **URL:** `http://fickle-tempest.picoctf.net:63798`

---

## Description

Challenge ini mengajarkan tentang manipulasi HTTP headers, khususnya User-Agent. Website hanya mengizinkan akses dari browser "picobrowser".

---

## Reconnaissance

### Step 1: Akses URL dengan browser normal

Ketika diakses dengan browser biasa, website menolak akses karena browser yang digunakan bukan "picobrowser".

### Step 2: Analisis requirement

Website melakukan checking berdasarkan **User-Agent header** yang dikirim oleh client.

---

## Concept: HTTP Headers & User-Agent

### Apa itu User-Agent?

User-Agent adalah HTTP header yang memberitahu server tentang:
- Browser yang digunakan (Chrome, Firefox, Safari, dll)
- Versi browser
- Operating System

**Contoh User-Agent:**
```
Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0 Safari/537.36
```

### Kenapa ini vulnerability?

User-Agent dapat dengan mudah di-manipulasi oleh attacker karena:
1. Header ini dikirim oleh client (bukan server)
2. Client memiliki kontrol penuh atas header yang dikirim
3. Tidak ada cara untuk memverifikasi keasliannya

---

## Solution

### Method 1: Using curl

```bash
curl -A "picobrowser" http://fickle-tempest.picoctf.net:63798/flag
```

**Penjelasan command:**
- `curl` - Command-line tool untuk HTTP requests
- `-A "picobrowser"` - Set User-Agent header ke "picobrowser"
- URL target

### Method 2: Using Browser DevTools

1. Buka Chrome/Firefox
2. Press `F12` untuk membuka DevTools
3. Press `Ctrl+Shift+P` (atau `Cmd+Shift+P` di Mac)
4. Ketik "network conditions"
5. Uncheck "Use browser default"
6. Di field User-Agent, ganti menjadi "picobrowser"
7. Refresh halaman

### Method 3: Using Browser Extension

Install extension seperti:
- User-Agent Switcher
- Modify Headers

---

## Flag

```
picoCTF{p1c0_s3cr3t_ag3nt_fba5c48f}
```

---

## Key Takeaways

### Security Lessons:

1. **User-Agent tidak aman untuk authentication**
   - Mudah di-fake
   - Tidak reliable
   - Hanya untuk informational purposes

2. **Client-side restrictions bisa di-bypass**
   - Semua yang dikirim client bisa dimanipulasi
   - Server tidak bisa memverifikasi keaslian header

3. **Proper authentication harus di server-side**
   - Gunakan session tokens
   - Implementasi proper authentication mechanism
   - Jangan percaya client-side data

### Technical Skills Learned:

- ✅ Understanding HTTP headers
- ✅ Using curl with custom headers
- ✅ Browser DevTools manipulation
- ✅ HTTP request/response analysis

---

## Prevention

Untuk mencegah vulnerability ini:

1. **Jangan gunakan User-Agent untuk authentication**
   ```python
   # ❌ BAD - Vulnerable
   if request.headers['User-Agent'] == 'picobrowser':
       return flag
   
   # ✅ GOOD - Secure
   if check_valid_session(request.session):
       return flag
   ```

2. **Implementasi proper authentication**
   - Session-based authentication
   - Token-based authentication (JWT, OAuth)
   - Multi-factor authentication

3. **Server-side validation**
   - Semua validasi harus di server
   - Never trust client data

---

## Additional curl Examples

```bash
# Basic request
curl http://example.com

# Custom User-Agent
curl -A "Mozilla/5.0" http://example.com

# View headers in response
curl -i http://example.com

# Follow redirects
curl -L http://example.com

# POST request with custom User-Agent
curl -X POST -A "custom-agent" http://example.com -d "data=value"
```

---

## Related Challenges

- don't-use-client-side (Client-side validation)
- Client-side-again (Advanced client-side bypass)

---

## References

- [MDN: User-Agent](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent)
- [curl documentation](https://curl.se/docs/manpage.html)
- [HTTP Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)

---

**Date Solved:** February 2026
